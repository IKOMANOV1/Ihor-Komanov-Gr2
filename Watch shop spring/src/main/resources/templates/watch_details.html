<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{layout :: head}"></head>

<body>

    <nav th:replace="~{layout :: navbar}"></nav>

    <main class="container py-5">
        <div class="row">
            <!-- Image Section -->
            <div class="col-md-6 mb-4">
                <div class="card bg-dark text-white border-0 shadow-sm">
                    <img th:if="${watch.imageUrl != null && !watch.imageUrl.empty}" th:src="${watch.imageUrl}"
                        class="card-img-top p-4" alt="Watch Image" style="height: 400px; object-fit: contain;">
                    <div th:unless="${watch.imageUrl != null && !watch.imageUrl.empty}"
                        class="card-body text-center py-5">
                        <span class="text-muted">No Image</span>
                    </div>
                </div>
            </div>

            <!-- Details Section -->
            <div class="col-md-6">
                <h1 class="display-5 fw-bold" th:text="${watch.nazwa}">Watch Name</h1>
                <h4 class="text-muted mb-4" th:text="${watch.brand}">Brand</h4>

                <h2 class="text-primary mb-3" th:text="${watch.price} + ' PLN'">0.00 PLN</h2>

                <p class="lead" th:text="${watch.description}">Description goes here.</p>

                <div class="mb-4">
                    <span th:if="${watch.inStock > 0}" class="badge bg-success">In Stock</span>
                    <span th:unless="${watch.inStock > 0}" class="badge bg-danger">Out of Stock</span>
                </div>

                <div class="d-grid gap-2 d-md-flex justify-content-md-start">
                    <button th:if="${watch.inStock > 0}" class="btn btn-primary btn-lg px-4 me-md-2"
                        th:onclick="'addToCart(' + ${watch.id} + ')'">
                        Add to Cart
                    </button>
                    <a href="/catalog" class="btn btn-outline-secondary btn-lg px-4">Back to Catalog</a>
                </div>
            </div>
        </div>
    </main>

    <div th:replace="~{layout :: footer}"></div>

    <script>
        function addToCart(watchId) {
            // Simplified AJAX add to cart reused from catalog
            fetch('/cart/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ watchId: watchId, quantity: 1 })
            })
                .then(response => {
                    if (response.ok) {
                        // Update cart badge if possible or just alert
                        location.reload();
                    } else if (response.status === 401) {
                        window.location.href = '/login';
                    } else {
                        alert('Error adding to cart');
                    }
                });
        }
    </script>

</body>

</html>